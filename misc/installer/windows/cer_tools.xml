<?xml version='1.0' encoding='windows-1252'?>
<Wix xmlns='http://schemas.microsoft.com/wix/2006/wi'>

  <?define PRODUCT_VERSION="1.0.0" ?>
  <?define MANUFACTURER="Centre for eResearch - University of Auckland" ?>
  <?define PRODUCT_NAME="$(var.MANUFACTURER) Toolkit" ?>
  <?define PRODUCT_SHORTCUT="CeRToolkit" ?>
  <?define UPGRADE_CODE="de9d8ee6-8449-4476-ab9e-5069c5f71720" ?>
  <?define README_GUID="4a2e445f-3f44-4403-9067-0bc23132db76" ?>
  <?define RJM_CONFIGURE_GUID="04fc1d50-2938-4470-abf4-347ec37e76f2" ?>
  <?define RJM_AUTHENTICATE_GUID="e3e85da3-3f97-4f89-b3b6-477816624e07" ?>
  <?define RJM_BATCH_CANCEL_GUID="365352ad-d7f5-4583-8ab6-9490633756e1" ?>
  <?define RJM_BATCH_CLEAN_GUID="0eef9ffd-e464-400a-a583-402316581a0e" ?>
  <?define RJM_BATCH_SUBMIT_GUID="6cb1d4db-8f46-4568-a161-fdb2d18b3d75" ?>
  <?define RJM_BATCH_WAIT_GUID="36e43004-7004-4865-a6f6-7f6f2cf96381" ?>
  <?define TOOLKIT_ENV_VAR_GUID="eab62114-03b5-45c9-bc87-af4dfd559e84" ?>

	<Product Name='$(var.PRODUCT_NAME)' Id='*' Language='1033'
		Codepage='1252' Version='$(var.PRODUCT_VERSION)' Manufacturer='$(var.MANUFACTURER)'
		UpgradeCode='$(var.UPGRADE_CODE)'>

		<Package Id='*' Keywords='Installer' Description="$(var.PRODUCT_NAME)"
			Manufacturer='$(var.MANUFACTURER)' InstallerVersion='100' Languages='1033'
			Compressed='yes' SummaryCodepage='1252' />

		<Directory Id='TARGETDIR' Name='SourceDir'>
			<Directory Id='ProgramFilesFolder' Name='PFiles'>
				<Directory Id='INSTALLDIR' Name='$(var.PRODUCT_SHORTCUT)'>
					<Component Id='toolkit_env_var' Guid='$(var.TOOLKIT_ENV_VAR_GUID)'>
						<CreateFolder />
						<Environment Id='ToolkitEnvVar' Name='CER_TOOLKIT_PATH'
							Action='set' Permanent='no' System='yes' Part='all' Value='[INSTALLDIR];[INSTALLDIR]\rjm' />
					</Component>
					<Directory Id='RjmDir' Name='rjm'>
  					<Component Id='rjm_readme' Guid='$(var.README_GUID)'>
	  					<File Id='rjm_readme_txt' DiskId='1' KeyPath='yes'
		  					Source='!(bindpath.doc_path)\readme.txt' />
		  			</Component>
						<Component Id='rjm_configure' Guid='$(var.RJM_CONFIGURE_GUID)'>
							<File Id='rjm_configure_exe' DiskId='1' KeyPath='yes'
								Source='!(bindpath.exe_path)\rjm_configure.exe' />
						</Component>
						<Component Id='rjm_authenticate' Guid='$(var.RJM_AUTHENTICATE_GUID)'>
							<File Id='rjm_authenticate_exe' DiskId='1' KeyPath='yes'
								Source='!(bindpath.exe_path)\rjm_authenticate.exe' />
						</Component>
						<Component Id='rjm_batch_cancel' Guid='$(var.RJM_BATCH_CANCEL_GUID)'>
							<File Id='rjm_batch_cancel_exe' DiskId='1' KeyPath='yes'
								Source='!(bindpath.exe_path)\rjm_batch_cancel.exe' />
						</Component>
						<Component Id='rjm_batch_clean' Guid='$(var.RJM_BATCH_CLEAN_GUID)'>
							<File Id='rjm_batch_clean_exe' DiskId='1' KeyPath='yes'
								Source='!(bindpath.exe_path)\rjm_batch_clean.exe' />
						</Component>
						<Component Id='rjm_batch_submit' Guid='$(var.RJM_BATCH_SUBMIT_GUID)'>
							<File Id='rjm_batch_submit_exe' DiskId='1' KeyPath='yes'
								Source='!(bindpath.exe_path)\rjm_batch_submit.exe' />
						</Component>
						<Component Id='rjm_batch_wait' Guid='$(var.RJM_BATCH_WAIT_GUID)'>
							<File Id='rjm_batch_wait_exe' DiskId='1' KeyPath='yes'
								Source='!(bindpath.exe_path)\rjm_batch_wait.exe' />
						</Component>
					</Directory>
				</Directory>
			</Directory>
		</Directory>

		<Feature Id='Complete' Title='$(var.PRODUCT_NAME)' Display='expand'
			Level='1' Description='The complete package.' ConfigurableDirectory='INSTALLDIR'>
			<ComponentRef Id='toolkit_env_var' />
			<ComponentRef Id='rjm_readme' />
			<ComponentRef Id='rjm_configure' />
			<ComponentRef Id='rjm_authenticate' />
			<ComponentRef Id='rjm_batch_cancel' />
			<ComponentRef Id='rjm_batch_clean' />
			<ComponentRef Id='rjm_batch_submit' />
			<ComponentRef Id='rjm_batch_wait' />
		</Feature>

		<Property Id="WIXUI_INSTALLDIR" Value="INSTALLDIR" />

		<UI>
			<UIRef Id="WixUI_InstallDir" />
			<UIRef Id="WixUI_ErrorProgressText" />
			<!-- Skip license dialog -->
			<Publish Dialog="WelcomeDlg" Control="Next" Event="NewDialog"
				Value="InstallDirDlg" Order="2">1</Publish>
			<Publish Dialog="InstallDirDlg" Control="Back" Event="NewDialog"
				Value="WelcomeDlg" Order="2">1</Publish>
		</UI>

		<Media Id='1' Cabinet='Sample.cab' EmbedCab='yes' DiskPrompt="CD-ROM #1" />
		<Property Id='DiskPrompt' Value="$(var.PRODUCT_NAME) [1]" />

	</Product>

</Wix>
